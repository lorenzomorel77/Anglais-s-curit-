<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Urban Mayor: Mission Sécurité</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Animations */
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
    </style>
</head>
<body class="bg-slate-900 text-slate-800 min-h-screen flex items-center justify-center p-4">

    <div id="root" class="w-full max-w-md"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- DONNÉES DU JEU (20 SCÉNARIOS) ---
        const SCENARIOS = [
            {
                id: 1,
                title: "Rodéos Urbains",
                description: "Des nuisances sonores et des conduites dangereuses sont signalées tous les soirs dans le quartier Nord.",
                image: "III) Delinquency Rodéo_page-0001.jpg",
                fallbackIcon: "fa-motorcycle",
                choices: [
                    { 
                        text: "Renforcer la Vidéo-protection", 
                        impact: { budget: -15, pop: -5, sec: +20 },
                        feedback: "Efficace pour identifier les auteurs, mais coûteux et mal vu par certains."
                    },
                    { 
                        text: "Médiation et Circuit dédié", 
                        impact: { budget: -5, pop: +10, sec: +5 },
                        feedback: "L'approche sociale calme le jeu, mais ne règle pas tout l'insécurité immédiate."
                    }
                ]
            },
            {
                id: 2,
                title: "Invasion de Rats",
                description: "La prolifération des rongeurs près des écoles inquiète les parents d'élèves.",
                image: "rats_problem.jpg", // Nom générique car pas spécifié dans le prompt
                fallbackIcon: "fa-bug", // Fallback visuel
                choices: [
                    { 
                        text: "Dératisation chimique massive", 
                        impact: { budget: -10, pop: +5, sec: +5 },
                        feedback: "Radical mais pose des questions environnementales."
                    },
                    { 
                        text: "Campagne propreté & poubelles fermées", 
                        impact: { budget: -5, pop: +15, sec: 0 },
                        feedback: "Plus long à mettre en place, mais améliore le cadre de vie durablement."
                    }
                ]
            },
            {
                id: 3,
                title: "Stationnement Anarchique",
                description: "Les trottoirs du centre-ville sont envahis, empêchant les piétons de circuler.",
                image: "parking.jpg",
                fallbackIcon: "fa-square-parking",
                choices: [
                    { 
                        text: "PV et enlèvements systématiques", 
                        impact: { budget: +5, pop: -15, sec: +10 },
                        feedback: "L'ordre règne, mais les commerçants et résidents hurlent au scandale."
                    },
                    { 
                        text: "Créer un parking relais gratuit", 
                        impact: { budget: -20, pop: +20, sec: +5 },
                        feedback: "Solution très populaire mais qui pèse lourd sur les finances."
                    }
                ]
            },
            {
                id: 4,
                title: "Rassemblements Tuning",
                description: "Un parking de supermarché devient une zone de non-droit le vendredi soir.",
                image: "III) Delinquency Rasso_page-0001.jpg",
                fallbackIcon: "fa-car-burst",
                choices: [
                    { 
                        text: "Barricader l'accès la nuit", 
                        impact: { budget: -5, pop: +5, sec: +10 },
                        feedback: "Simple et efficace, le problème est déplacé ailleurs."
                    },
                    { 
                        text: "Intervention police municipale", 
                        impact: { budget: -10, pop: -5, sec: +15 },
                        feedback: "Risque de tensions, mais affirme l'autorité de la ville."
                    }
                ]
            },
            {
                id: 5,
                title: "Sans-abri en Centre-ville",
                description: "Le nombre de SDF augmente, créant un sentiment d'insécurité et de détresse sociale.",
                image: "homeless.jpg",
                fallbackIcon: "fa-person-shelter",
                choices: [
                    { 
                        text: "Arrêtés anti-mendicité", 
                        impact: { budget: 0, pop: -10, sec: +5 },
                        feedback: "Mesure cosmétique très critiquée par les associations."
                    },
                    { 
                        text: "Ouvrir un centre d'accueil", 
                        impact: { budget: -15, pop: +15, sec: +10 },
                        feedback: "Humaniste et sécurisant à long terme."
                    }
                ]
            },
            {
                id: 6,
                title: "Prostitution",
                description: "Des réseaux s'installent dans une zone résidentielle périphérique.",
                image: "III) Delinquency Prostituée_page-0001.jpg",
                fallbackIcon: "fa-person-dress",
                choices: [
                    { 
                        text: "Harcèlement policier des clients", 
                        impact: { budget: -10, pop: +5, sec: +15 },
                        feedback: "Réduit la demande visible mais ne démantèle pas les réseaux."
                    },
                    { 
                        text: "Accompagnement social des victimes", 
                        impact: { budget: -10, pop: +10, sec: 0 },
                        feedback: "Essentiel pour aider les personnes, impact lent sur la sécurité."
                    }
                ]
            },
            {
                id: 7,
                title: "Drogues et Alcool",
                description: "Squat de hall d'immeuble et consommation sur la voie publique.",
                image: "III) Delinquency Alcool et drogue_page-0001.jpg",
                fallbackIcon: "fa-pills",
                choices: [
                    { 
                        text: "Opération 'Place Nette' (Police)", 
                        impact: { budget: -10, pop: +5, sec: +20 },
                        feedback: "Le calme revient temporairement, les dealers changent juste de hall."
                    },
                    { 
                        text: "Éducateurs de rue + Prévention", 
                        impact: { budget: -5, pop: +10, sec: +5 },
                        feedback: "Travail de fond indispensable pour la jeunesse."
                    }
                ]
            },
            {
                id: 8,
                title: "Blanchiment d'Argent",
                description: "Plusieurs commerces 'vitrines' (barbers, snacks) ouvrent sans jamais avoir de clients.",
                image: "III) Delinquency Blanchiment d_argent_page-0001.jpg",
                fallbackIcon: "fa-money-bill-transfer",
                choices: [
                    { 
                        text: "Contrôles d'hygiène et administratifs", 
                        impact: { budget: -5, pop: 0, sec: +10 },
                        feedback: "Le levier administratif permet de fermer ces lieux illégaux."
                    },
                    { 
                        text: "Laisser faire la Police Nationale", 
                        impact: { budget: 0, pop: -5, sec: -5 },
                        feedback: "L'enquête est longue, pendant ce temps l'économie souterraine prospère."
                    }
                ]
            },
            {
                id: 9,
                title: "Harcèlement de Rue",
                description: "Les signalements de sifflements et d'agressions verbales explosent près de la gare.",
                image: "III) Delinquency Micro agression_page-0001.jpg",
                fallbackIcon: "fa-person-harassing",
                choices: [
                    { 
                        text: "Marches exploratoires & Éclairage", 
                        impact: { budget: -10, pop: +15, sec: +10 },
                        feedback: "Réaménager l'espace urbain rassure et dissuade."
                    },
                    { 
                        text: "Patrouilles en civil", 
                        impact: { budget: -10, pop: +5, sec: +15 },
                        feedback: "Permet quelques flagrants délits mais climat anxiogène."
                    }
                ]
            },
            {
                id: 10,
                title: "Cambriolages",
                description: "Une vague de vols par effraction touche les quartiers pavillonnaires.",
                image: "III) Delinquency Cambriolage_page-0001.jpg",
                fallbackIcon: "fa-mask",
                choices: [
                    { 
                        text: "Dispositif 'Voisins Vigilants'", 
                        impact: { budget: -2, pop: +5, sec: +10 },
                        feedback: "Favorise l'entraide citoyenne à moindre coût."
                    },
                    { 
                        text: "Police montée (Chevaux)", 
                        impact: { budget: -15, pop: +15, sec: +5 },
                        feedback: "Très bonne image et hauteur de vue, mais onéreux."
                    }
                ]
            },
            {
                id: 11,
                title: "Squat / Bidonville",
                description: "Un terrain vague est occupé illégalement. Conditions sanitaires déplorables.",
                image: "III) Delinquency Bidonville_page-0001.jpg",
                fallbackIcon: "fa-tents",
                choices: [
                    { 
                        text: "Expulsion immédiate (Bulldozer)", 
                        impact: { budget: -10, pop: -10, sec: +10 },
                        feedback: "Règle le problème visuel, mais crée une crise humanitaire."
                    },
                    { 
                        text: "Diagnostic social et relogement", 
                        impact: { budget: -20, pop: +10, sec: +5 },
                        feedback: "Processus long et coûteux, respectueux des droits."
                    }
                ]
            },
            {
                id: 12,
                title: "Trafic d'Armes",
                description: "Des rumeurs font état de circulation d'armes dans certains quartiers.",
                image: "III) Delinquency Traffic arme_page-0001.jpg",
                fallbackIcon: "fa-gun",
                choices: [
                    { 
                        text: "Coopération étroite État/Police", 
                        impact: { budget: -5, pop: +5, sec: +20 },
                        feedback: "C'est une compétence régalienne, la mairie doit soutenir l'État."
                    },
                    { 
                        text: "Ignorer (Pas ma compétence)", 
                        impact: { budget: 0, pop: -10, sec: -20 },
                        feedback: "Dangereux ! Le maire est officier de police judiciaire."
                    }
                ]
            },
            {
                id: 13,
                title: "Vols de Véhicules",
                description: "Vol à la roulotte et vols de voitures en hausse.",
                image: "III) Delinquency Vol et dégradation_page-0001.jpg",
                fallbackIcon: "fa-car-side",
                choices: [
                    { 
                        text: "Campagne de sensibilisation", 
                        impact: { budget: -2, pop: +5, sec: 0 },
                        feedback: "Rappeler de ne rien laisser en vue aide, mais ne suffit pas."
                    },
                    { 
                        text: "Pièges photographiques (LAPI)", 
                        impact: { budget: -15, pop: 0, sec: +15 },
                        feedback: "Lecture Automatique des Plaques très efficace pour retrouver les véhicules."
                    }
                ]
            },
            {
                id: 14,
                title: "Attentats",
                description: "Niveau d'alerte écarlate. Un événement public majeur approche.",
                image: "III) Delinquency Attentats_page-0001.jpg",
                fallbackIcon: "fa-person-military-rifle",
                choices: [
                    { 
                        text: "Annuler l'événement", 
                        impact: { budget: -5, pop: -20, sec: +25 },
                        feedback: "Sécurité maximale, mais la vie sociale s'arrête."
                    },
                    { 
                        text: "Barrières béton et fouilles", 
                        impact: { budget: -20, pop: +10, sec: +10 },
                        feedback: "Maintient la fête sous haute surveillance."
                    }
                ]
            },
            {
                id: 15,
                title: "Inondations",
                description: "Orages violents annoncés. Le quartier bas est inondable.",
                image: "flood.jpg",
                fallbackIcon: "fa-house-flood-water",
                choices: [
                    { 
                        text: "Déclenchement Plan Communal (PCS)", 
                        impact: { budget: -10, pop: +10, sec: +15 },
                        feedback: "L'organisation des secours est optimale. Des vies sont sauvées."
                    },
                    { 
                        text: "Attendre de voir l'évolution", 
                        impact: { budget: 0, pop: -5, sec: -10 },
                        feedback: "Risqué. La réaction tardive provoque des dégâts matériels."
                    }
                ]
            },
            {
                id: 16,
                title: "Logement Insalubre",
                description: "Un marchand de sommeil exploite des locataires dans un immeuble en péril.",
                image: "slum.jpg",
                fallbackIcon: "fa-house-crack",
                choices: [
                    { 
                        text: "Arrêté de péril imminent", 
                        impact: { budget: -10, pop: +10, sec: +10 },
                        feedback: "L'immeuble est évacué, les locataires protégés."
                    },
                    { 
                        text: "Médiation avec le propriétaire", 
                        impact: { budget: -2, pop: -10, sec: -5 },
                        feedback: "Inefficace face à un propriétaire malhonnête."
                    }
                ]
            },
            {
                id: 17,
                title: "Manifestations",
                description: "Un mouvement social prévoit de bloquer la rocade.",
                image: "protest.jpg",
                fallbackIcon: "fa-bullhorn",
                choices: [
                    { 
                        text: "Négocier le parcours", 
                        impact: { budget: -5, pop: +10, sec: +5 },
                        feedback: "Permet l'expression démocratique en limitant la casse."
                    },
                    { 
                        text: "Demander l'interdiction au Préfet", 
                        impact: { budget: 0, pop: -15, sec: +10 },
                        feedback: "Risque de transformer la manif en émeute sauvage."
                    }
                ]
            },
            {
                id: 18,
                title: "Réseaux Sociaux & Rumeurs",
                description: "Une fake news sur un enlèvement d'enfant crée la panique.",
                image: "social_panic.jpg",
                fallbackIcon: "fa-mobile-screen-button",
                choices: [
                    { 
                        text: "Communiqué officiel immédiat", 
                        impact: { budget: 0, pop: +10, sec: +10 },
                        feedback: "La parole officielle coupe court à la rumeur."
                    },
                    { 
                        text: "Ne pas réagir pour ne pas amplifier", 
                        impact: { budget: 0, pop: -10, sec: -5 },
                        feedback: "Le silence est interprété comme un aveu de faiblesse."
                    }
                ]
            },
            {
                id: 19,
                title: "Nomades / Gens du Voyage",
                description: "Installation illicite de 50 caravanes sur le stade municipal.",
                image: "caravan.jpg",
                fallbackIcon: "fa-caravan",
                choices: [
                    { 
                        text: "Couper eau et électricité", 
                        impact: { budget: 0, pop: -5, sec: -10 },
                        feedback: "Augmente les tensions et les risques sanitaires."
                    },
                    { 
                        text: "Proposer un terrain provisoire", 
                        impact: { budget: -10, pop: +5, sec: +10 },
                        feedback: "Libère le stade tout en gérant l'accueil légal."
                    }
                ]
            },
            {
                id: 20,
                title: "Cyberattaque Mairie",
                description: "Les serveurs de l'état civil sont bloqués par un ransomware.",
                image: "hacker.jpg",
                fallbackIcon: "fa-laptop-code",
                choices: [
                    { 
                        text: "Payer la rançon", 
                        impact: { budget: -25, pop: -10, sec: -10 },
                        feedback: "Illégal et finance le crime. Aucune garantie de retour."
                    },
                    { 
                        text: "Activer le plan de continuité (Papier)", 
                        impact: { budget: -10, pop: +5, sec: +15 },
                        feedback: "Service dégradé mais résilient. On ne cède pas."
                    }
                ]
            }
        ];

        // --- COMPOSANTS ---

        // Gestionnaire d'image avec Fallback automatique
        const SmartImage = ({ src, fallbackIcon, alt }) => {
            const [hasError, setHasError] = useState(false);

            if (hasError) {
                return (
                    <div className="w-full h-48 bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center rounded-lg shadow-inner mb-4">
                        <i className={`fa-solid ${fallbackIcon} text-6xl text-white opacity-80 drop-shadow-lg`}></i>
                    </div>
                );
            }

            return (
                <div className="w-full h-48 overflow-hidden rounded-lg mb-4 bg-slate-200">
                    <img 
                        src={src} 
                        alt={alt} 
                        className="w-full h-full object-cover"
                        onError={() => setHasError(true)}
                    />
                </div>
            );
        };

        const Gauge = ({ label, value, color, icon }) => {
            let colorClass = "bg-green-500";
            if (value < 50) colorClass = "bg-yellow-500";
            if (value < 20) colorClass = "bg-red-600";
            if (color) colorClass = color;

            return (
                <div className="flex flex-col w-full mb-2">
                    <div className="flex justify-between text-xs font-bold text-slate-300 mb-1">
                        <span className="flex items-center gap-1"><i className={`fa-solid ${icon}`}></i> {label}</span>
                        <span>{Math.round(value)}%</span>
                    </div>
                    <div className="w-full bg-slate-700 rounded-full h-2.5">
                        <div className={`${colorClass} h-2.5 rounded-full transition-all duration-500`} style={{ width: `${Math.max(0, Math.min(100, value))}%` }}></div>
                    </div>
                </div>
            );
        };

        const Button = ({ children, onClick, variant = "primary", className = "" }) => {
            const baseStyle = "w-full py-3 px-4 rounded-lg font-bold transition transform hover:scale-105 active:scale-95 shadow-lg flex items-center justify-center gap-2";
            const variants = {
                primary: "bg-blue-600 hover:bg-blue-500 text-white",
                secondary: "bg-slate-600 hover:bg-slate-500 text-white",
                success: "bg-green-600 hover:bg-green-500 text-white",
                danger: "bg-red-500 hover:bg-red-400 text-white"
            };
            return (
                <button onClick={onClick} className={`${baseStyle} ${variants[variant]} ${className}`}>
                    {children}
                </button>
            );
        };

        // --- MOTEUR DU JEU ---

        const App = () => {
            const [screen, setScreen] = useState('start'); // start, game, feedback, end
            const [stats, setStats] = useState({ budget: 50, pop: 50, sec: 50 });
            const [scenarioIndex, setScenarioIndex] = useState(0);
            const [lastFeedback, setLastFeedback] = useState("");
            const [history, setHistory] = useState([]);

            const currentScenario = SCENARIOS[scenarioIndex];

            const handleChoice = (choice) => {
                const newStats = {
                    budget: Math.min(100, Math.max(0, stats.budget + choice.impact.budget)),
                    pop: Math.min(100, Math.max(0, stats.pop + choice.impact.pop)),
                    sec: Math.min(100, Math.max(0, stats.sec + choice.impact.sec)),
                };

                setStats(newStats);
                setLastFeedback(choice.feedback);
                setHistory([...history, { title: currentScenario.title, choice: choice.text, result: choice.impact }]);
                setScreen('feedback');
            };

            const nextScenario = () => {
                if (scenarioIndex + 1 < SCENARIOS.length) {
                    setScenarioIndex(scenarioIndex + 1);
                    setScreen('game');
                } else {
                    setScreen('end');
                }
            };

            const calculateRank = () => {
                const total = stats.budget + stats.pop + stats.sec;
                if (total < 100) return "Maire Débutant";
                if (total < 180) return "Maire Gestionnaire";
                if (total < 240) return "Maire Engagé";
                return "Maire Visionnaire";
            };

            const getRankIcon = () => {
                const total = stats.budget + stats.pop + stats.sec;
                if (total < 100) return "fa-baby";
                if (total < 180) return "fa-briefcase";
                if (total < 240) return "fa-medal";
                return "fa-crown";
            };

            // ÉCRAN ACCUEIL
            if (screen === 'start') {
                return (
                    <div className="bg-white rounded-xl shadow-2xl p-8 text-center max-w-lg fade-in border-t-4 border-blue-600">
                        <div className="mb-6">
                            <i className="fa-solid fa-city text-6xl text-blue-600"></i>
                        </div>
                        <h1 className="text-3xl font-extrabold text-slate-800 mb-2">URBAN MAYOR</h1>
                        <h2 className="text-xl font-bold text-blue-600 mb-4">Mission Sécurité</h2>
                        <p className="text-slate-600 mb-6">
                            Vous venez d'être élu maire. Vous allez faire face à 20 situations de crise réelles.
                            Votre objectif : maintenir l'équilibre entre <strong>Budget</strong>, <strong>Bonheur</strong> et <strong>Sécurité</strong>.
                        </p>
                        <div className="bg-blue-50 p-4 rounded-lg mb-6 text-sm text-left border border-blue-100">
                            <h3 className="font-bold mb-2 text-blue-800"><i className="fa-solid fa-circle-info"></i> Règles du jeu :</h3>
                            <ul className="list-disc pl-5 space-y-1 text-slate-700">
                                <li>Il n'y a pas de "Game Over".</li>
                                <li>Chaque décision a des conséquences.</li>
                                <li>Gérez les 20 dossiers pour voir votre bilan.</li>
                            </ul>
                        </div>
                        <Button onClick={() => setScreen('game')}>Prendre mes fonctions</Button>
                    </div>
                );
            }

            // ÉCRAN DE JEU
            if (screen === 'game') {
                return (
                    <div className="bg-slate-800 rounded-xl shadow-2xl overflow-hidden w-full max-w-md border border-slate-700 fade-in">
                        {/* Header Stats */}
                        <div className="bg-slate-900 p-4 border-b border-slate-700">
                            <div className="flex justify-between items-end mb-2">
                                <span className="text-white font-bold text-sm">Dossier {scenarioIndex + 1}/20</span>
                                <span className="text-slate-400 text-xs">Mairie de Ville-Neuve</span>
                            </div>
                            <div className="space-y-2">
                                <Gauge label="Budget" value={stats.budget} icon="fa-coins" color="bg-amber-400" />
                                <Gauge label="Population" value={stats.pop} icon="fa-face-smile" color="bg-blue-400" />
                                <Gauge label="Sécurité" value={stats.sec} icon="fa-shield-halved" color="bg-emerald-500" />
                            </div>
                        </div>

                        {/* Scenario Card */}
                        <div className="p-6 bg-white">
                            <h2 className="text-xl font-bold text-slate-800 mb-2">{currentScenario.title}</h2>
                            
                            <SmartImage 
                                src={currentScenario.image} 
                                fallbackIcon={currentScenario.fallbackIcon} 
                                alt={currentScenario.title} 
                            />

                            <p className="text-slate-600 mb-6 min-h-[60px]">{currentScenario.description}</p>

                            <div className="space-y-3">
                                {currentScenario.choices.map((choice, idx) => (
                                    <button 
                                        key={idx}
                                        onClick={() => handleChoice(choice)}
                                        className="w-full text-left p-4 rounded-lg border-2 border-slate-200 hover:border-blue-500 hover:bg-blue-50 transition-all group"
                                    >
                                        <div className="font-bold text-slate-800 group-hover:text-blue-700">{choice.text}</div>
                                        <div className="text-xs text-slate-400 mt-1 flex gap-2">
                                            {choice.impact.budget !== 0 && <span className={choice.impact.budget > 0 ? "text-green-600" : "text-red-500"}>Budget {choice.impact.budget > 0 ? '+' : ''}{choice.impact.budget}</span>}
                                            {choice.impact.pop !== 0 && <span className={choice.impact.pop > 0 ? "text-green-600" : "text-red-500"}>Pop {choice.impact.pop > 0 ? '+' : ''}{choice.impact.pop}</span>}
                                            {choice.impact.sec !== 0 && <span className={choice.impact.sec > 0 ? "text-green-600" : "text-red-500"}>Sec {choice.impact.sec > 0 ? '+' : ''}{choice.impact.sec}</span>}
                                        </div>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            // ÉCRAN FEEDBACK (Résultat immédiat)
            if (screen === 'feedback') {
                return (
                    <div className="bg-white rounded-xl shadow-2xl p-6 text-center max-w-sm slide-in border-t-4 border-slate-600">
                        <div className="mb-4">
                            <i className="fa-solid fa-check-circle text-5xl text-green-500"></i>
                        </div>
                        <h3 className="text-xl font-bold mb-3">Décision entérinée</h3>
                        <p className="text-slate-600 mb-6 italic">"{lastFeedback}"</p>
                        
                        <div className="grid grid-cols-3 gap-2 mb-6 text-xs font-bold">
                            <div className="p-2 bg-slate-100 rounded">
                                <div className="text-slate-400">Budget</div>
                                <div className={stats.budget < 30 ? "text-red-500" : "text-slate-800"}>{Math.round(stats.budget)}%</div>
                            </div>
                            <div className="p-2 bg-slate-100 rounded">
                                <div className="text-slate-400">Pop.</div>
                                <div className={stats.pop < 30 ? "text-red-500" : "text-slate-800"}>{Math.round(stats.pop)}%</div>
                            </div>
                            <div className="p-2 bg-slate-100 rounded">
                                <div className="text-slate-400">Sécu.</div>
                                <div className={stats.sec < 30 ? "text-red-500" : "text-slate-800"}>{Math.round(stats.sec)}%</div>
                            </div>
                        </div>

                        <Button onClick={nextScenario} variant="secondary">Dossier Suivant <i className="fa-solid fa-arrow-right"></i></Button>
                    </div>
                );
            }

            // ÉCRAN FIN
            if (screen === 'end') {
                const rank = calculateRank();
                const rankIcon = getRankIcon();

                return (
                    <div className="bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-lg fade-in my-8">
                        <div className="bg-blue-900 p-8 text-center text-white">
                            <div className="w-24 h-24 bg-blue-800 rounded-full flex items-center justify-center mx-auto mb-4 border-4 border-blue-400">
                                <i className={`fa-solid ${rankIcon} text-4xl`}></i>
                            </div>
                            <h2 className="text-2xl font-bold uppercase tracking-wider">Mandat Terminé</h2>
                            <h1 className="text-3xl font-extrabold text-blue-300 mt-2">{rank}</h1>
                        </div>

                        <div className="p-6">
                            <div className="mb-6">
                                <h3 className="font-bold text-slate-700 mb-3 border-b pb-2">Bilan Statistique</h3>
                                <Gauge label="Santé Financière" value={stats.budget} icon="fa-coins" color="bg-amber-400" />
                                <Gauge label="Bonheur Citoyen" value={stats.pop} icon="fa-face-smile" color="bg-blue-400" />
                                <Gauge label="Sécurité Publique" value={stats.sec} icon="fa-shield-halved" color="bg-emerald-500" />
                            </div>

                            <div className="bg-slate-50 p-4 rounded-lg border border-slate-200 mb-6">
                                <h3 className="font-bold text-slate-700 mb-2"><i className="fa-solid fa-book-open"></i> Ressources & Formation</h3>
                                <p className="text-sm text-slate-600 mb-4">
                                    Pour approfondir vos connaissances sur les dispositifs de sécurité réelle :
                                </p>
                                <div className="flex flex-col gap-3">
                                    <a href="GUIDE SÉCURITÉ.pdf" target="_blank" className="flex items-center justify-between p-3 bg-white border border-slate-300 rounded hover:bg-blue-50 hover:border-blue-300 transition text-blue-700 font-bold text-sm">
                                        <span><i className="fa-solid fa-file-pdf mr-2"></i> Fascicule Complet</span>
                                        <i className="fa-solid fa-download"></i>
                                    </a>
                                    <button onClick={() => alert("Ouverture des planches d'exposition...")} className="flex items-center justify-between p-3 bg-white border border-slate-300 rounded hover:bg-purple-50 hover:border-purple-300 transition text-purple-700 font-bold text-sm">
                                        <span><i className="fa-solid fa-images mr-2"></i> Planches d'Exposition</span>
                                        <i className="fa-solid fa-eye"></i>
                                    </button>
                                </div>
                            </div>

                            <Button onClick={() => window.location.reload()} variant="primary">
                                <i className="fa-solid fa-rotate-right"></i> Nouveau Mandat
                            </Button>
                        </div>
                    </div>
                );
            }
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
